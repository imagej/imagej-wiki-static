<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>LimeSeg - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"LimeSeg","wgTitle":"LimeSeg","wgCurRevisionId":39955,"wgRevisionId":39955,"wgArticleId":10255,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"LimeSeg","wgRelevantArticleId":10255,"wgRequestId":"50fa32cb2b675291fc81503f","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cskins.erudite&amp;only=styles&amp;skin=erudite.css"/>
<script async="" src="../load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=erudite"></script>
<link rel="stylesheet" href="../extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="../extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=erudite.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="A Fiji plugin for the segmentation of 3D objects."/>
<link rel="shortcut icon" href="../skins/ij2.ico"/>
	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="LimeSeg"/>

	<meta property="og:description" content="A Fiji plugin for the segmentation of 3D objects."/>

	<meta property="og:url" content="http://imagej.net/LimeSeg"/>

<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-LimeSeg rootpage-LimeSeg skin-erudite action-view">
		<div class="mw-jump">
			<a href="index.html#bodyContent">Skip to content</a>, 			<a href="index.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="index.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">
			<div id="nav-meta">
			<span id="ca-nstab-main" class="selected"><a href="index.html" title="View the content page [c]" accesskey="c">Page</a></span><span class="meta-sep">|</span><span id="ca-talk" class="new"><a href="index.php?title=Talk:LimeSeg&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span><span class="meta-sep">|</span><span id="ca-viewsource"><a href="index.php?title=LimeSeg&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span><span class="meta-sep">|</span><span id="ca-history"><a href="index.php?title=LimeSeg&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></span><span class="meta-sep">|</span>			</div>

			<div id="bodyContent">
				<h1>LimeSeg</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table class="infobox" cellspacing="5" style="max-width: 31em; font-size: 90%; text-align: left; float: right; border: 1px solid #a0a0a0;">
<tr>
<th colspan="2" style="text-align: center; font-size: 130%;"> <div style="float: left"></div>LimeSeg (Fiji)<div style="clear: left;"></div>
</th></tr>
<tr>
<th> Author
</th>
<td> <a rel="nofollow" class="external text" href="https://github.com/NicoKiaru">Nicolas Chiaruttini</a>, Sarah Machado
</td></tr>
<tr>
<th> Update site
</th>
<td> <a href="Following_an_update_site" title="Following an update site">LimeSeg</a>
</td></tr>



<tr>
<th> Maintainer
</th>
<td> <a rel="nofollow" class="external text" href="https://github.com/NicoKiaru">Nicolas Chiaruttini</a>
</td></tr>


<tr>
<th> Source
</th>
<td> <a rel="nofollow" class="external text" href="https://github.com/NicoKiaru/LimeSeg/">on GitHub</a>
</td></tr>
<tr>
<th> Initial release
</th>
<td> 01/2018
</td></tr>


<tr>
<th> Category
</th>
<td> <a href="Category:Segmentation" title="Category:Segmentation">Segmentation</a>, <a href="Category:Plugins" title="Category:Plugins">Category:Plugins</a>
</td></tr>

</table>
<p><br />
</p><p><br />
<b>A Fiji plugin for the segmentation of 3D objects. </b>
</p>
<pre><a rel="nofollow" class="external text" href="Following_an_update_site">Enable the LimeSeg update site</a> to get it.
</pre>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="index.html#Publication."><span class="tocnumber">1</span> <span class="toctext">Publication.</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="index.html#Video_tutorials"><span class="tocnumber">2</span> <span class="toctext">Video tutorials</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="index.html#Presentation."><span class="tocnumber">3</span> <span class="toctext">Presentation.</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="index.html#Commands_:_basic_usage"><span class="tocnumber">4</span> <span class="toctext">Commands&#160;: basic usage</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="index.html#Single_object_segmentation"><span class="tocnumber">4.1</span> <span class="toctext">Single object segmentation</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="index.html#Sphere_Seg_command"><span class="tocnumber">4.1.1</span> <span class="toctext">Sphere Seg command</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="index.html#Refining_a_segmentation_result"><span class="tocnumber">4.1.2</span> <span class="toctext">Refining a segmentation result</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="index.html#Alternative_ways_to_segment_a_single_object:_multiple_spheres_and_skeletons"><span class="tocnumber">4.1.3</span> <span class="toctext">Alternative ways to segment a single object: multiple spheres and skeletons</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="index.html#Multiple_objects_segmentation"><span class="tocnumber">4.2</span> <span class="toctext">Multiple objects segmentation</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="index.html#Others_commands"><span class="tocnumber">4.3</span> <span class="toctext">Others commands</span></a>
<ul>
<li class="toclevel-3 tocsection-11"><a href="index.html#Cancelling_a_segmentation_result"><span class="tocnumber">4.3.1</span> <span class="toctext">Cancelling a segmentation result</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="index.html#Clearing_all_segmented_objects"><span class="tocnumber">4.3.2</span> <span class="toctext">Clearing all segmented objects</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="index.html#Stopping_a_segmentation_in_progress"><span class="tocnumber">4.3.3</span> <span class="toctext">Stopping a segmentation in progress</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="index.html#LimeSeg_3D_Viewer_.28basic.29"><span class="tocnumber">4.4</span> <span class="toctext">LimeSeg 3D Viewer (basic)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="index.html#Advanced_usage"><span class="tocnumber">5</span> <span class="toctext">Advanced usage</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="index.html#Graphical_user_interface"><span class="tocnumber">5.1</span> <span class="toctext">Graphical user interface</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="index.html#LimeSeg_structure"><span class="tocnumber">5.2</span> <span class="toctext">LimeSeg structure</span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="index.html#LimeSeg_3D_objects_management"><span class="tocnumber">5.2.1</span> <span class="toctext">LimeSeg 3D objects management</span></a>
<ul>
<li class="toclevel-4 tocsection-19"><a href="index.html#Vizualizing_3D_Objects"><span class="tocnumber">5.2.1.1</span> <span class="toctext">Vizualizing 3D Objects</span></a></li>
<li class="toclevel-4 tocsection-20"><a href="index.html#Creating_a_new_Cell"><span class="tocnumber">5.2.1.2</span> <span class="toctext">Creating a new Cell</span></a></li>
<li class="toclevel-4 tocsection-21"><a href="index.html#.27Populating.27_a_Cell"><span class="tocnumber">5.2.1.3</span> <span class="toctext">'Populating' a Cell</span></a></li>
<li class="toclevel-4 tocsection-22"><a href="index.html#Deleting_a_Cell"><span class="tocnumber">5.2.1.4</span> <span class="toctext">Deleting a Cell</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-23"><a href="index.html#LimeSeg_optimizer_usage"><span class="tocnumber">5.2.2</span> <span class="toctext">LimeSeg optimizer usage</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="index.html#LimeSeg_I.2FO"><span class="tocnumber">5.2.3</span> <span class="toctext">LimeSeg I/O</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="index.html#LimeSeg_3D_Viewer_.28advanced.29"><span class="tocnumber">5.3</span> <span class="toctext">LimeSeg 3D Viewer (advanced)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26"><a href="index.html#Script_examples"><span class="tocnumber">6</span> <span class="toctext">Script examples</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Publication.">Publication.</span></h2>
<p>LimeSeg: a coarse-grained lipid membrane simulation for 3D image segmentation
</p><p>BMC Bioinformatics doi: <a rel="nofollow" class="external text" href="https://doi.org/10.1186/s12859-018-2471-0">http://dx.doi.org/10.1186/s12859-018-2471-0</a>
</p>
<h2><span class="mw-headline" id="Video_tutorials">Video tutorials</span></h2>
<p>Probably the fastest to learn how to use LimeSeg at a basic level. You can find <a rel="nofollow" class="external text" href="https://www.youtube.com/playlist?list=PLrEbS8VRQh9qhFYH-9YnVwzMDQBGfCKVj">here a playlist containing all the tutorials</a>. This playlist contains tutorials for:
</p>
<ul><li> <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=ZAFzMa0eZ0w">Single object segmentation</a></li>
<li> <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=u4BwSHclTMM">Multiple objects segmentation</a></li>
<li> <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=3MtdKeM1xTU">Segmentation refinement</a></li>
<li> <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=3J4RpjE7Gsg">Single object segmentation with multiple seeds</a></li>
<li> <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=GmJA4w9gNO4">An example of a C. Elegans embryo segmentation (one time point)</a></li>
<li> <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=Ta911ULSWUI">Single object segmentation with a pre-defined shape</a></li>
<li> <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=i9OC8H6gFA4">Computing and displaying surface curvature</a></li></ul>
<h2><span class="mw-headline" id="Presentation.">Presentation.</span></h2>
<p>LimeSeg is a modular 3D segmentation plugin. It is a particle-based active contour method. It can segment objects from 3D images where 3D objects are labelled on their outline, like cells labeled on their membrane, as shown in the image below (source of the image&#160;: <a rel="nofollow" class="external free" href="https://loci.wisc.edu/sample-data/dub">https://loci.wisc.edu/sample-data/dub</a>).
</p>
<div class="MediaTransformError" style="width: 384px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>LimeSeg can be used with simple commands provided by the plugin (under Plugins&gt;LimeSeg in ImageJ menu), or on a more advanced manner with scripting capabilities of ImageJ (macro commands of ImageJ1 or preferentially with <a href="Groovy_Scripting" title="Groovy Scripting">groovy scripts</a>).
</p>
<h1><span class="mw-headline" id="Commands_:_basic_usage">Commands&#160;: basic usage</span></h1>
<h2><span class="mw-headline" id="Single_object_segmentation">Single object segmentation</span></h2>
<h3><span class="mw-headline" id="Sphere_Seg_command">Sphere Seg command</span></h3>
<p>The command Sphere Seg (<b>Plugins&gt;LimeSeg&gt;Sphere Seg</b>) is the easiest way to use LimeSeg. It allows to segment a 3D object starting from a spherical seed. Here's an example to show how to use it:
</p><p>1. Open a sample vesicle image. To do this, do <b>File&gt;Import&gt;URL..</b> and enter the address <a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/NicoKiaru/TestImages/master/Vesicles/Vesicles.tif">https://raw.githubusercontent.com/NicoKiaru/TestImages/master/Vesicles/Vesicles.tif</a>
</p><p>2. Draw a circular ROI that is contained within the vesicle And save it in the ROI manager with the t key or with Edit&gt;Selection&gt;Add To Manager (only this ROI should be contained in the ROI manager).
</p>
<div class="MediaTransformError" style="width: 682px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>3. Execute the Sphere Seg command&#160;: <b>Plugins&gt;LimeSeg&gt;Sphere Seg</b>
</p><p>4. You need to provide the four most important parameters: 
</p>
<ul><li> <b>D_0</b>: this parameter expressed in numbers of pixels (it can be a real value like 1.2 pixels) is the smallest feature size that you want LimeSeg to detect. A low value (~ 1 pixel) will lead to fine details being detected, at the cost of speed. A too high value will lead to important details being missed. The value is typically between 1 and &gt;20 pixels. (More precisely, D_0 is the equilibrium spacing between the particles used by LimeSeg to delineate the 3D shape.)</li>
<li> <b>F_pressure</b> is the "default pressure" exerted on the surface (also called balloon force in related active contour methods). A positive value will lead to expansion of the surface by default, while a negative value will lead to shrinking. Its typical range is [-0.03..0.03]. </li>
<li> <b>Z_Scale</b> is the physical ratio of the spacing between slices (Z spacing) and between pixels (X or Y spacing). The vesicles were imaged with pixels of 133 nm and a z-spacing of 340 nm. Hence this parameter should be set to 340/133 ~ 2.54.</li>
<li> <b>Range in d0 units</b> is the size over which each particle will look for a local maximum. A value of 2 with a D_0 of 2 means that a local maximum will be looked for within a layer of 2*2 = [-4..+4] pixels around the surface. Typical values are from 0.5 to &gt;10.</li></ul>
<p>5. Other parameters:
</p>
<ul><li> <b>show 3D</b>&#160;: if checked, displays a 3D view of the segmented objects. For more options, see #ref 3D viewer (TODO).</li>
<li> <b>same cell</b>: this parameter is not important in this case, since only a single ROI is provided. It will become useful when multiple seeds are needed, see #ref multiple objects (TODO) and #single big objects.</li>
<li> <b>Optimisation steps</b>&#160;: number of optimization steps. If set to -1, the optimization will take place until convergence is met.</li>
<li> <b>real size XY</b>&#160;: the size of a XY pixel in physical units. Here a pixel is 133 nm. To get the volume and surface in microns squared and microns cubed units, set this parameter to 0.133.</li></ul>
<p>To segment this demo image, please choose the parameters as in this image:
</p>
<div class="MediaTransformError" style="width: 431px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>After convergence, you can go through the 2D image and you should see some points along the objects, like this:
</p>
<div class="MediaTransformError" style="width: 460px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>Also the 3D viewer should give a 3D View of the vesicle:
</p>
<div class="MediaTransformError" style="width: 305px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>Other outputs are provided as an ImageJ table:
<a href="File:LimeSeg_Results_Vesicle.png" class="image"><img alt="LimeSeg Results Vesicle.png" src="../../_images/f/ff/LimeSeg_Results_Vesicle.png" width="1000" height="80" /></a>
</p><p><br />
</p>
<ul><li> <b>Cell_Name</b>&#160;: each 3D object that LimeSeg generated is a "Cell" object. By default, these objects have a String identifier: Cell_0, Cell_1, Cell_2...</li>
<li> <b>Number of Surfels</b>&#160;: number of surface elements in the generated 3D object. This number is also the number of vertex within the 3D Mesh.</li>
<li> <b>Center X,Y,Z</b>&#160;: position of the center of mass of the object Vertexes, expressed in pixels for XY, and in slice number for Z (using IJ1 numbering)</li>
<li> <b>Frame</b>&#160;: frame where the object has been segmented</li>
<li> <b>Channel</b>&#160;: Channel where the object has been segmented</li>
<li> <b>Mesh?</b>&#160;: indicates where a mesh has been reconstructed from the object surfels</li>
<li> <b> Euler characteristic</b>&#160;: <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Euler_characteristic">Euler characteristic</a> of the reconstructed mesh. This value needs to be 2 for a simply closed surface, 0 for a torus, etc. If its value is not in accordance with your expectations, the surface and volume values will be wrong.</li>
<li> <b> Free edges</b>&#160;: Number of free edges of the 3D reconstructed mesh. Should be equal to zero to trust the given surface and volume.</li>
<li> <b> Surface </b>&#160;: Surface of the object in (XY_pixels)^2 units</li>
<li> <b> Volume </b>&#160;: Surface of the object in (XY_pixels)^3 units</li>
<li> <b> Real Surface </b>&#160;: Physical surface of the object</li>
<li> <b> Real Volume </b>&#160;: Physical volume of the object</li></ul>
<p><b>Troubleshooting</b>
</p>
<ul><li> If the circle ROI is too small, the sphere will disappear immediately -&gt; make a bigger circular ROI.</li>
<li> If the circle ROI is too big or not fully contained into the  vesicle, the surface could leak outside -&gt; recenter the ROI.</li>
<li> "the segmentation goes crazy and I'd like to stop it". You can either execute the command <b>Plugins&gt;LimeSeg&gt;Stop Optimisation</b>, or you can set a value different from -1 in the number of optimisation steps parameter (10000 steps is enough for this demo case).</li></ul>
<h3><span class="mw-headline" id="Refining_a_segmentation_result">Refining a segmentation result</span></h3>
<p>It is possible to refine a segmentation by decreasing D_0 after a first roughly defined shape is found. Doing a first segmentation at a high D_0 and then decreasing it by refinement is usually faster than starting the segmentation at a low D_0 value. This can be done after a first segmentation by using the <b>Plugins&gt;LimeSeg&gt;Coarsen/Refine</b> command.
</p><p>For instance, in the vesicle example:
1 - Right after the convergence is reached for D_0 = 4, launch the "Plugins&gt;LimeSeg&gt;Coarsen/Refine" command with these parameters: 
Choose the following parameters: D_0_ini = 4; D_0_end = 2; range_in_D_O_units=2.
2 - After the command is finished, you need to resume the segmentation until convergence is newly reached. To do this, execute the command <b>Plugins&gt;LimeSeg&gt;Resume Seg</b>. You can keep F_pressure to zero, since no bias is required anymore, and set the real size of the pixel as before (0.133).
</p><p>The shape is now more precise, as you can see in the 2D view and in 3D:
</p>
<div class="MediaTransformError" style="width: 853px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<h3><span class="mw-headline" id="Alternative_ways_to_segment_a_single_object:_multiple_spheres_and_skeletons">Alternative ways to segment a single object: multiple spheres and skeletons</span></h3>
<p>If the object you want to segment is tortuous or big, starting with a single spherical may not give good results. Here are two alternative ways to segment a single object.
</p><p><b> Starting with multiple spherical seeds </b>
</p><p>The sample image accessible here: <a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/NicoKiaru/TestImages/master/ER/ER-FIB-SEM-Small.tif">https://raw.githubusercontent.com/NicoKiaru/TestImages/master/ER/ER-FIB-SEM-Small.tif</a> (use <b>File&gt;Import&gt;URL</b>) is a piece of endoplasmic reticulum and is pretty tortuous. While you may get a correct result with one circular ROI as a seed and with the <b>Sphere Seg</b> command (D_0 = 2 and F_pressure=0.02 gives good results), one can also store several circular ROI in the ROI manager at different places in the piece of ER. Lauching the <b>Sphere Seg</b> command and checking the <b>same Cell</b> checkbox will lead to a faster segmentation. When the different seeds meet, they will merge into a single surface.
</p><p>For instance for three spherical seeds:
</p>
<div class="MediaTransformError" style="width: 478px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>Final result:
</p>
<div class="MediaTransformError" style="width: 795px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p><b> Starting with a ROI skeleton</b>
</p><p>It is possible to define more precisely the seeds used to segment images. This can be useful for instance to predefine the structure you want to segment. Let's show how this works through an example, like the segmentation of the contour of the CElegans embryo:
</p><p>1. Download a 3D C. Elegans embry image (<b>File&gt;Import&gt;URL..</b>) from here: <a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/NicoKiaru/TestImages/master/CElegans/dub19-half.tif">https://raw.githubusercontent.com/NicoKiaru/TestImages/master/CElegans/dub19-half.tif</a> which is a timepoint extracted from the full dataset (<a rel="nofollow" class="external free" href="https://loci.wisc.edu/software/sample-data">https://loci.wisc.edu/software/sample-data</a>).
</p><p>2. Using a few ROIs approximately define the contour of the embryo at certains slices, like in the image shown above:
</p><p><a href="File:LimeSeg_Skeleton_Example.png" class="image"><img alt="LimeSeg Skeleton Example.png" src="../../_images/8/84/LimeSeg_Skeleton_Example.png" width="1000" height="222" /></a>
</p><p>You need to begin and end with a single point ROI, otherwise the shape will not be closed. Also, the ROIs need to be drawn clockwise and should starts always at the same angle (start on top for instance).
</p><p>3. Launch the <b>Plugins&gt;LimeSeg&gt;Skeleton Seg</b> command, without anything else in the ROI manager. Using the parameters D_0=10, F_pressure = 0, range_in _d0_units=2 and Z_scale=3.5 should give correct results, like shown below:
</p>
<div class="MediaTransformError" style="width: 755px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<h2><span class="mw-headline" id="Multiple_objects_segmentation">Multiple objects segmentation</span></h2>
<p>It is possible to segment multiple non overlapping objects with LimeSeg. The most basic way to do this is through the Sphere Seg command. In order too to an example, you can open the test image fo C Elegans with File&gt;Import&gt;URL.. 
This is a timepoint extracted from this dataset:
</p><p><a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/NicoKiaru/TestImages/master/CElegans/dub19-half.tif">https://raw.githubusercontent.com/NicoKiaru/TestImages/master/CElegans/dub19-half.tif</a>
</p><p>Like previously, you can store a single circular ROI in the ROI manager and launch the Sphere Seg command. This set of parameters work nicely:
</p>
<ul><li> D_0 = 4</li>
<li> F_Pressure = 0.015</li>
<li> Range_in_D0_units = 1.5</li>
<li> ZScale=3.5</li></ul>
<p>In this kind of image, you'd probably like to segment multiple cells. You can do this one at a time, but sometimes one segmented surface will leak onto another, because the frontiers are sometimes not well defined. One way to avoid this is to segment multiple cells in parallel and avoid surface overlap. LimeSeg can do this&#160;: you can define several seeds defining several objects. In this case, the surfaces will repel each other, a bit resembling watershed methods in that aspect.
</p><p>You can define multiple seeds (one per cell) simply by storing multiple circular ROIs in the ROI manager. Like in this image:
</p>
<div class="MediaTransformError" style="width: 620px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>Of course the seeds can be located at different planes.
</p><p>You can then launch the <b>Plugins&gt;LimeSeg&gt;Sphere Seg</b> command with the previously defined parameters, but <b>be sure to uncheck the sameCell checkbox</b> (otherwise surfaces will merge):
</p>
<div class="MediaTransformError" style="width: 428px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>You should obtain an image similar to this:
</p>
<div class="MediaTransformError" style="width: 698px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>If you want to segment the whole embryo, you'll need to provide the location of the cell centers, and then launch the command. The following groovy script will segment the demo image here:
</p><p>[groovy script]
</p><p>Providing the result image:
</p><p>[image]
</p><p>The colors are chosen randomly and you should be able to vizualize the result both in 2D and 3D, similar to this:
[Images]
</p><p>The output table also displays the surface and volume of the segmented cells.
</p>
<h2><span class="mw-headline" id="Others_commands">Others commands</span></h2>
<h3><span class="mw-headline" id="Cancelling_a_segmentation_result">Cancelling a segmentation result</span></h3>
<p>To cancel the last launched segmentation command, you can launch the command&#160;: <b>Plugins &gt; LimeSeg &gt; Cancel Last Optimisation</b>
</p><p>The segmentation needs to be stopped before applying this command.
</p>
<h3><span class="mw-headline" id="Clearing_all_segmented_objects">Clearing all segmented objects</span></h3>
<ul><li> launch the command&#160;: <b>Plugins &gt; LimeSeg &gt; Clear all</b></li></ul>
<p>Should be used cautiously&#160;: this erases all objects segmented by LimeSeg so far.
</p>
<h3><span class="mw-headline" id="Stopping_a_segmentation_in_progress">Stopping a segmentation in progress</span></h3>
<ul><li> Command <b>Plugins&gt;LimeSeg&gt;Stop optimization</b></li></ul>
<h2><span class="mw-headline" id="LimeSeg_3D_Viewer_.28basic.29">LimeSeg 3D Viewer (basic)</span></h2>
<p>So far LimeSeg provides its own 3D vizualizer. The 3D viewer looks at a specific point in 3D. Arrows keyboard allow to move this central point. Mouse dragging allows to rotate around this point. Zoom/zoom out can be done with the mouse wheel.
</p>
<h1><span class="mw-headline" id="Advanced_usage">Advanced usage</span></h1>
<h2><span class="mw-headline" id="Graphical_user_interface">Graphical user interface</span></h2>
<p>The command <b>Plugins&gt;LimeSeg&gt; Show GUI</b> displays LimeSeg GUI. This graphical interface allows to do almost everything in LimeSeg. Each action (meaning button you click) is recordable if you have opened the plugins&gt;macro&gt;Record recorder.
</p><p>To execute the script in ImageJ1 macro language, just add <b>run("Show GUI");</b> as the first line of your script.
</p><p>To execute the script in Groovy, replace <b>Ext.</b> by <b>LimeSeg.</b>, and put <b>import eu.kiaru.limeseg.LimeSeg;</b> at the beginning of the script.
</p>
<h2><span class="mw-headline" id="LimeSeg_structure">LimeSeg structure</span></h2>
<p>LimeSeg is composed of multiple parts. It can:
</p>
<ul><li> <b>Manage</b> 3D objects (creation, deletion, copying, pasting, saving, opening...), </li>
<li> <b>Optimize</b> 3D object shape in relation with an image dataset</li>
<li> <b>Display</b> these 3D objects both in 2D with point Roi and in 3D with its own vizualizer</li></ul>
<h3><span class="mw-headline" id="LimeSeg_3D_objects_management">LimeSeg 3D objects management</span></h3>
<p>To help understand how LimeSeg does this, please download this sample dataset output (unzip file <a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/NicoKiaru/TestImages/master/LimeSegOutput/DubSeg.zip">https://raw.githubusercontent.com/NicoKiaru/TestImages/master/LimeSegOutput/DubSeg.zip</a>).
</p><p>Open Fiji, then launch LimeSeg GUI (<b>Plugins&gt;LimeSeg&gt;Show GUI</b>).
LimeSeg graphical user interface pops up (click ok on the warning message).
The GUI consists of an upper panel that can apply different actions on LimeSeg. 
Tabs separate the different kinds of objects where actions can be applied. 
The lower part contains information about LimeSeg state.
</p>
<div class="MediaTransformError" style="width: 471px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<p>To load the sample dataset onto LimeSeg, do the following actions:
</p><p>1. Unzip the zip dataset sample
</p><p>2. In LimeSeg GUI I/O tab, click <b>Load From:</b> button
</p><p>3. Select the <b>DubSeg</b> folder that you have unzipped. Click ok. Note that selecting the folder do not open it. To open the data, you need to do the step 4.
</p><p>4. Click <b>loadStateFromXmlPly</b> button in LimeSeg GUI
</p><p>Now click <b>showTable</b> in the <b>STATE</b> tab. This creates a <b>Cells explorer</b> table which shows all the 3D objects segmented by LimeSeg and how they are organized. Each column represents a <b>Cell</b> object which name is at the top of the tab, like <b>cell_2</b>. Rows are timepoints. A cell object may contain many <b>CellT</b> objects, which stands for <b>Cell</b> at a specific <b>T</b>imepoint. For instance, the Cell <b>cell_56</b> contains 10 CellT objects, for timepoints 12 to 22.
</p>
<div class="MediaTransformError" style="width: 450px; height: 0px; display:inline-block;">Error creating thumbnail: Unable to save thumbnail to destination</div>
<h4><span class="mw-headline" id="Vizualizing_3D_Objects">Vizualizing 3D Objects</span></h4>
<p>In LimeSeg GUI, go to 3D View, click <b>make3DViewVisible</b>, then <b>putAllCellsTo3DDisplay</b>. This displays the C Elegans embryo, but only at the first timepoint (timepoint 1 by convention in ImageJ1). However as seen in the table, many more objects exist. To be able to see the evolution of the embryo over time, LimeSeg has to be linked to an ImageJ image (ImagePlus). To link LimeSeg with the proper image, download the image sample (<a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/NicoKiaru/TestImages/master/CElegans/dub-0.5xy-TP1-22.tif">https://raw.githubusercontent.com/NicoKiaru/TestImages/master/CElegans/dub-0.5xy-TP1-22.tif</a>) and open it in Fiji.
</p><p>Now you need to link the Image with LimeSeg:
</p><p>1. Click <b>Img:</b> in the STATE tab of LimeSeg GUI, and select the image. Click OK. <b>This has no effect at this step</b>.
</p><p>2. Once the image is selected, click <b>setWorkingImage</b>
</p><p>Notice that the image name appears in the LimeSeg GUI down panel.
You can now browse through timepoints and notice that the 3D Viewer is synchronized with the current displayed timepoint. The 3D Viewer is also synchronized with the z Slice which appears downlighted in the 3D Viewer.
</p>
<h4><span class="mw-headline" id="Creating_a_new_Cell">Creating a new Cell</span></h4>
<p>In LimeSeg GUI, click <b>newCell</b> in the STATE tab. You can see that a <b>cell_0</b> has appeared at the end of the Cells explorer table.
</p>
<h4><span class="mw-headline" id=".27Populating.27_a_Cell">'Populating' a Cell</span></h4>
<p>A prerequisite to act on a specific cell is to make sure that it is the current cell (or active cell). The current or active cell name is displayed in the LimeSeg state panel (Cells: current=...) and its column is highlighted in blue in the Cells explorer window. To change the current Cell of LimeSeg you can either:
</p>
<ul><li> Double click on it on the Cells explorer table</li>
<li> Use the <b>selectCellById</b> button in the STATE pane (fill in the string id parameter on the right (like 'cell_10') before clicking)</li>
<li> Use the <b>selectCellByNumber</b> button in the STATE pane (fill in the numeric parameter on the right before clicking)</li></ul>
<p>Make sure the current Cell is cell_0. It should be empty. You can check this in the Cells explorer windows. Two ways can be used to populate the cell. Both implies the use of Clipped Dots 'buffer' object that will contain either simple shapes or copies of existing CellT objects.
</p><p>1. Creating a sphere
</p><p>Go to the <b>Clipped Dots</b> tab. At the right of the makeSphere button, fill in the 4 white boxes. They correspond to the center of the sphere (x,y,z, radius). All units are in pixel except for z which is in number of slice. Enter 180, 130, 19, 100 for instance. Then click the <b>makeSphere</b> button. A sphere object has been created in the clipped dots buffer objects. This can be vizualized in the lower panel of LimeSeg GUI (Clipped dots: #dots=). 
</p><p>2. Pasting the sphere into a Cell Object
</p><p>To put the sphere into the current Cell, go to the Current CellT tab, and click <b>pasteDotsToCellT</b>. Notice that the Cells explorer now displays C(7906) for the currentCell at the TimePoint 1. And the 3D viewer is updated. Now this sphere was pasted at the TimePoint 1, why&#160;? Because LimeSeg has an active or a current frame parameter which is 1 by default. The current frame is another parameter that can be set within LimeSeg. Its current value is displayed in the  lower panel of LimeSeg GUI. To change this parameter, go to the STATE tab and in front of the setCurrentFrame button, type 10 for instance. Now click the <b>setCurrentFrame</b> button. The active frame is now 10. If you now click again on <b>pasteDotsToCellT</b>, the clipped dots (i.e. the sphere) are pasted are the timepoint 10 of the current Cell.
</p><p>3. Deleting a Cell Timpepoint (CellT object)
</p><p>Set properly the active Cell (see above how to select the active cell) and the active timepoint (STATE &gt; setCurrentFrame).
</p><p>Click <b>Current CellT &gt; clearDotsFromCellT</b>
</p>
<h4><span class="mw-headline" id="Deleting_a_Cell">Deleting a Cell</span></h4>
<p>As an example, we will delete the newly created Cell <b>cell_0</b>. First of all, you need to set the cell that you want to delete as the <b>currentCell</b> of LimeSeg. 
</p><p>Click in the tab <b>Current Cell</b> the button <b>clearCurrentCell</b>
</p>
<h3><span class="mw-headline" id="LimeSeg_optimizer_usage">LimeSeg optimizer usage</span></h3>
<p>To allow for a proper usage of LimeSeg optimizer, the way it can function is modular. To make it work without commands, here are the steps that should be followed: 
</p>
<ul><li> Select the 3D image to work with:
<ul><li> STATE tab &gt; Select the image with the Img: button then click on setWorkingImage</li>
<li> Choose the correct Timepoint with setCurrentFrame button</li>
<li> Choose the correct Channel with the setCurrentChannel button</li></ul></li></ul>
<ul><li> Set the ratio of Z spacing versus XY spacing. ( For instance 5 for 200 nm per pixel and 1 um per slice).
<ul><li> Goto the Otimizer tab.</li>
<li> In the first right box next to setOptimizerParameter, put 'Z_scale'</li>
<li> In the second, put the correct numeric parameter (1 for isotropic acquisition)</li>
<li> Click the setOptimizerParameter button (compulsory)</li></ul></li></ul>
<p>We now suppose that you already have created 3D objects that you want to optimize. Object creation is succintly explained in 3D object manipulation section.
</p>
<ul><li> Now the optimizer knows which image it should use, but there are no 3D objects into it. 3D Objects are called CellT objects in LimeSeg (for cell timepoint). To add such objects into the optimizer, you need, for each object you want to put in:
<ul><li> Set the current or active Cell as the one you want to use</li>
<li> Set the current Frame parameter you are working</li>
<li> Go to the Current CellT tab, and click 'putCurrentCellTToOptimizer</li>
<li> Notice in the GUI down panel, the number of dots in Optimizer #dots: should increase</li></ul></li></ul>
<ul><li> Set the Optimizer parameters.
<ul><li> Similarly to Z_scale, you can set various parameters for the Optimizer</li>
<li> f_pressure</li>
<li> d_0 (this should be done before)</li>
<li> and many others... (needs full documentation)</li></ul></li></ul>
<p><br />
</p>
<ul><li> You now need to run the optimizer
<ul><li> In the Optimizer tab, set the number of optimization step you want to perform (-1 means until convergence), then click <b>runOptimisation</b></li></ul></li></ul>
<h3><span class="mw-headline" id="LimeSeg_I.2FO">LimeSeg I/O</span></h3>
<p>3D objects generated by LimeSeg can be saved and retrieved. The structure choice was done with several convention that LimeSeg uses, in order to simplify objects manipulation outside of FIJI.
</p><p>If you download and unzip the sample file  <a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/NicoKiaru/TestImages/master/LimeSegOutput/DubSeg.zip">https://raw.githubusercontent.com/NicoKiaru/TestImages/master/LimeSegOutput/DubSeg.zip</a>, you will see that the folder contains an xml file which contains the last segmentation parameters (LimeSegParams.xml) and one folder per Cell object. In each folder, named according to the Cell id object, a CellParams.xml file contains the parameters specific to the Cell object, and CellT objects (Cell at a specific timepoint), consists of files T_x.ply where x is the timepoint number and where ply is the standard 3D format used. <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/PLY_(file_format)">PLY</a> file format is standard and can be used in many other 3D software.
</p><p>To save the current objects of LimeSeg, choose an EMPTY folder in LimeSeg GUI I/O Tab (<b>Plugins&gt;LimeSeg&gt; Show GUI</b>), with the button <b>WriteTo:</b>, then click on the <b>saveStateToXmlPly </b> button.
</p><p>To open previously saved data, select the folder with the LoadFrom: button then click loadStateFromXmlPly button. This erases all previous data contained in LimeSeg.
</p>
<h2><span class="mw-headline" id="LimeSeg_3D_Viewer_.28advanced.29">LimeSeg 3D Viewer (advanced)</span></h2>
<ul><li> Image synchronization</li></ul>
<p>LimeSeg 3D viewer is synchronized with the workingImage of LimeSeg state. This image is automatically set by the user selection during a command launch. However, it can also be set within the LimeSeg GUI. To select this image, go to the STATE tab, then choose the proper image by clicking on img, then click on "setWorkingImage" button (do not forget this, otherwise the image selection has no effect).
</p><p>The synchronization occurs since the current slice is highlighted (downlighted...) in the 3D view in synchronization with the selected slice in the 2D view. Also change frame will change the 3D object displayed in case of a multiframe image.
</p>
<ul><li> Other 3D View parameters.</li></ul>
<p>The other parameters can be modified within the 3D View Panel. In LimeSeg GUI, the command is executed once the user clicks on the left most button. The other text area are parameters that should be specified before clicking the command button.
</p>
<ul><li><ul><li> set3DViewMode If the parameter is 0, all the volumes of the 3D objects are displayed, like this:</li></ul></li></ul>
<p>1&#160;: the objects are cropped at the position of zposition (cut above)
</p><p>2&#160;: (cut below)
</p><p>3&#160;: only the current slice is displayed (cut above and below).
</p><p>8&#160;: If an optimization is occuring, the optimized dots are displayed (green, dots which have converged, red, dots which have not converged).
</p><p><br />
</p>
<h1><span class="mw-headline" id="Script_examples">Script examples</span></h1>
<p>Example scripts (ImageJ1 and groovy) are available here:
</p><p><a rel="nofollow" class="external free" href="https://github.com/NicoKiaru/LimeSeg/tree/master/src/main/resources/script-templates/LimeSeg">https://github.com/NicoKiaru/LimeSeg/tree/master/src/main/resources/script-templates/LimeSeg</a>
</p><p>They are also accessible as templates in ImageJ script editor (<a rel="nofollow" class="external free" href="Using_the_Script_Editor">https://imagej.net/Using_the_Script_Editor</a>), if the LimeSeg update site is enabled.
</p>
<!-- 
NewPP limit report
Cached time: 20200714212557
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.092 seconds
Real time usage: 0.153 seconds
Preprocessor visited node count: 896/1000000
Preprocessor generated node count: 4008/1000000
Postâ€expand include size: 1363/2097152 bytes
Template argument size: 587/2097152 bytes
Highest expansion depth: 10/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%   30.600      1 - Template:Infobox
100.00%   30.600      1 - -total
 80.51%   24.635      3 - Template:Person
  5.76%    1.764      1 - Template:GitHub
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=LimeSeg&amp;oldid=39955">http://imagej.net/index.php?title=LimeSeg&amp;oldid=39955</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 17 May 2019, at 06:07.</p><ul><li><a href="ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li><li><a href="index.php?title=LimeSeg&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li></ul>			</div>

			<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>		</div>

		<div id="bottom-wrap">
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":388});});</script>
		</body>
		</html>
		