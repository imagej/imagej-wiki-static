<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>TrackMate Performance - ImageJ</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"TrackMate_Performance","wgTitle":"TrackMate Performance","wgCurRevisionId":9536,"wgRevisionId":9536,"wgArticleId":2008,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"TrackMate_Performance","wgRelevantArticleId":2008,"wgRequestId":"eb515bf0a58a6f84d31b14bb","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","fancytree_path":"/extensions/TreeAndMenu/fancytree"});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user.cssprefs":"ready","user":"ready","user.options":"loading","user.tokens":"loading","ext.cite.styles":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","skins.erudite":"ready"});mw.loader.implement("user.options@0j3lz3q",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens@1ku9xth",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=ext.cite.styles%257Cmediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cskins.erudite&amp;only=styles&amp;skin=erudite.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=erudite"></script>
<link rel="stylesheet" href="extensions/TreeAndMenu/fancytree/fancytree.css"/><link rel="stylesheet" href="extensions/TreeAndMenu/suckerfish/suckerfish.css"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=erudite.css"/>
<meta name="generator" content="MediaWiki 1.28.0"/>
<meta name="description" content="This is a very incomplete DRAFT"/>
<link rel="shortcut icon" href="skins/ij2.ico"/>
	<meta property="og:type" content="article"/>

	<meta property="og:site_name" content="ImageJ"/>

	<meta property="og:title" content="TrackMate Performance"/>

	<meta property="og:description" content="This is a very incomplete DRAFT"/>


<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-TrackMate_Performance rootpage-TrackMate_Performance skin-erudite action-view">
		<div class="mw-jump">
			<a href="TrackMate_Performance.html#bodyContent">Skip to content</a>, 			<a href="TrackMate_Performance.html#search">Skip to search</a>
		</div>

		<div id="top-wrap" role="banner">
			<h1><a href="Welcome" title="ImageJ" rel="home">ImageJ</a></h1>
			<div id="tagline">From ImageJ</div>

			<a id="menubutton" href="TrackMate_Performance.html#menu">Menu</a>
			<div id="nav" role="navigation">
			<ul id='menu'>
<li id="menu-item-n-About"><a href="ImageJ">About</a></li>
<li id="menu-item-n-Downloads"><a href="Downloads">Downloads</a></li>
<li id="menu-item-n-Learn"><a href="Learn">Learn</a></li>
<li id="menu-item-n-Develop"><a href="Development">Develop</a></li>
<li id="menu-item-n-News"><a href="News">News</a></li>
<li id="menu-item-n-Events"><a href="Events">Events</a></li>
<li id="menu-item-n-Help"><a href="Help">Help</a></li>
</ul>
			</div>
		</div>

		<div id="mw-js-message"></div>
		
		<div id="main" role="main">
			<div id="nav-meta">
			<span id="ca-nstab-main" class="selected"><a href="TrackMate_Performance" title="View the content page [c]" accesskey="c">Page</a></span><span class="meta-sep">|</span><span id="ca-talk" class="new"><a href="index.php?title=Talk:TrackMate_Performance&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span><span class="meta-sep">|</span><span id="ca-viewsource"><a href="index.php?title=TrackMate_Performance&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span><span class="meta-sep">|</span><span id="ca-history"><a href="index.php?title=TrackMate_Performance&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></span><span class="meta-sep">|</span>			</div>

			<div id="bodyContent">
				<h1>TrackMate Performance</h1>
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p><b> This is a very incomplete DRAFT </b>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="TrackMate_Performance.html#The_test_machine"><span class="tocnumber">1</span> <span class="toctext">The test machine</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="TrackMate_Performance.html#Time_of_execution."><span class="tocnumber">2</span> <span class="toctext">Time of execution.</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="TrackMate_Performance.html#The_DoG_.26_LoG_detectors."><span class="tocnumber">2.1</span> <span class="toctext">The DoG &amp; LoG detectors.</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="TrackMate_Performance.html#Processing_time_for_a_2D_image_as_a_function_of_its_size."><span class="tocnumber">2.1.1</span> <span class="toctext">Processing time for a 2D image as a function of its size.</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="TrackMate_Performance.html#Processing_time_for_a_3D_image_as_a_function_of_its_size."><span class="tocnumber">2.1.2</span> <span class="toctext">Processing time for a 3D image as a function of its size.</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="TrackMate_Performance.html#Processing_time_for_a_2D_image_as_a_function_of_the_spot_radius."><span class="tocnumber">2.1.3</span> <span class="toctext">Processing time for a 2D image as a function of the spot radius.</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="TrackMate_Performance.html#Processing_time_for_a_3D_image_as_a_function_of_the_spot_radius."><span class="tocnumber">2.1.4</span> <span class="toctext">Processing time for a 3D image as a function of the spot radius.</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="TrackMate_Performance.html#Choosing_between_DoG_and_LoG_based_on_performance"><span class="tocnumber">2.1.5</span> <span class="toctext">Choosing between DoG and LoG based on performance</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="The_test_machine">The test machine</span></h2>
<p>The computer used for these tests is the following:
</p>
<pre> Mac¬Pro
 mi-2010
 Processor  2 x 2.66 GHz 6-Core Intel Xeon
 Memory  24 GB 1333 MHz DDR3 ECC
 Software  Mac OS X Lion 10.7.5 (11G63)
</pre>
<p><br />
</p>
<h2><span class="mw-headline" id="Time_of_execution.">Time of execution.</span></h2>
<p>The tests reported here were run on an Apple MacPro, 2 x 2.66 GHz 6-Core Intel Xeon, 24 Go 1333 MHz DDR3, running Mac OS X v10.7.5, with Java 1.6. The detectors instantiated were tamed to use only 1 thread. Unless indicated, the median filter and the sub-pixel localization were not done. 
</p>
<h3><span class="mw-headline" id="The_DoG_.26_LoG_detectors.">The DoG &amp; LoG detectors.</span></h3>
<h4><span class="mw-headline" id="Processing_time_for_a_2D_image_as_a_function_of_its_size.">Processing time for a 2D image as a function of its size.</span></h4>
<p>For a <i>uint16</i> image, varying its size, containing 200 gaussian spots of radius 3 (everything is in pixel units).
</p>
<table class="wikitable" cellspacing="10">
<tr>
<th align="left">N (pixels)
</th>
<th>Image size
</th>
<th>DoG detector time (ms)
</th>
<th>LoG detector time (ms)
</th></tr>
<tr>
<td>256
</td>
<td>16x16
</td>
<td>3.0
</td>
<td>4.8
</td></tr>
<tr>
<td>1024
</td>
<td>32x32
</td>
<td>2.95
</td>
<td>4.3
</td></tr>
<tr>
<td>4096
</td>
<td>64x64
</td>
<td>3.95
</td>
<td>4.35
</td></tr>
<tr>
<td>16384
</td>
<td>128x128
</td>
<td>7.9
</td>
<td>5.85
</td></tr>
<tr>
<td>65536
</td>
<td>256x256
</td>
<td>23.35
</td>
<td>17.7
</td></tr>
<tr>
<td>262144
</td>
<td>512x512
</td>
<td>88.2
</td>
<td>61.15
</td></tr>
<tr>
<td>1048576
</td>
<td>1024x1024
</td>
<td>357.3
</td>
<td>251.65
</td></tr>
<tr>
<td>2359296
</td>
<td>1536x1536
</td>
<td>789.85
</td>
<td>605.4
</td></tr>
<tr>
<td>4194304
</td>
<td>2048x2048
</td>
<td>1463.4
</td>
<td>1201.1
</td></tr></table>
<p>For the DoG detector, unsurprisingly, we find that the execution time is proportional to the number of pixels, following approximately <i>t (ms) = 3.4e-4 x Npixels</i>. This is expected as all calculations are done in direct space.
</p><p>The LoG detector operates in Fourier space, and because of the Fourier transform implementation we use, the images are padded with 0s to reach a size equal to a power of 2. This does not show here as all but one tests are made with such a size. Still, the execution time slightly deviates from the linear case, and shows a slight quadratic shape. The best linear fit yields a low in <i>t (ms) = 2.8e-4 x Npixels</i>, showing that the LoG detector is slightly quicker than the DoG detector.
</p><p><a href="./File:TrackMate_DoGandLoGTimeVsPixels.png" class="image"><img alt="TrackMate DoGandLoGTimeVsPixels.png" src="_images/f/f3/TrackMate_DoGandLoGTimeVsPixels.png" width="400" height="289" /></a>
</p><p><br />
</p>
<h4><span class="mw-headline" id="Processing_time_for_a_3D_image_as_a_function_of_its_size.">Processing time for a 3D image as a function of its size.</span></h4>
<table class="wikitable" cellspacing="10">
<tr>
<th align="left">N (pixels)
</th>
<th>Image size
</th>
<th>DoG detector time (ms)
</th>
<th>LoG detector time (ms)
</th></tr>
<tr>
<td>4096
</td>
<td>16x16x16
</td>
<td>8.7
</td>
<td>24.7
</td></tr>
<tr>
<td>32768
</td>
<td>32x32x32
</td>
<td>23.5
</td>
<td>38.5
</td></tr>
<tr>
<td>262144
</td>
<td>64x64x64
</td>
<td>129.3
</td>
<td>159.2
</td>
<td>
</td></tr>
<tr>
<td>2097152
</td>
<td>128x128x128
</td>
<td>875.1
</td>
<td>936.3
</td></tr>
<tr>
<td>16777216
</td>
<td>256x256x256
</td>
<td>7054.0
</td>
<td>7462.4
</td></tr>
<tr>
<td>134217728
</td>
<td>512x512x512
</td>
<td>61477.2
</td>
<td>58860.6
</td></tr></table>
<p>And again, the processing time is found to be linear with the number of pixels. The linear fit is slightly steeper, however: <i>t (ms) = 4.6e-4 x Npixels</i>, which we attribute to the 3D kernel overhead.
</p><p>Interestingly, the LoG detector seems to become the slowest at intermediate size, which I cannot interpret well. 
</p><p><a href="./File:TrackMate_DoGandLoGTimeVsPixels3D.png" class="image"><img alt="TrackMate DoGandLoGTimeVsPixels3D.png" src="_images/d/db/TrackMate_DoGandLoGTimeVsPixels3D.png" width="400" height="296" /></a>
</p><p><br />
</p><p><br />
</p>
<h4><span class="mw-headline" id="Processing_time_for_a_2D_image_as_a_function_of_the_spot_radius.">Processing time for a 2D image as a function of the spot radius.</span></h4>
<p>We used a 1024x1024 <i>uint16</i> image, with 200 gaussian spots, the size of which we varied. The detector was tuned to this radius. 
</p><p><a href="./File:TrackMate_DoGandLoGTimeVsRadius2D.png" class="image"><img alt="TrackMate DoGandLoGTimeVsRadius2D.png" src="_images/2/2f/TrackMate_DoGandLoGTimeVsRadius2D.png" width="400" height="285" /></a>
</p><p>We find that for the DoG detector, the processing time to increase linearly with the specified radius, following approximately <i>t (ms) = 20.5 x radius + 260</i>. As the difference-of-gaussians is calculated in the direct space, a marked increase is expected as there is more pixels to iterate over. Without optimization, we should however have found the time to be increasing with the square of the radius, and find the same dependence that for the image size. Thanks to the clever implementation of gaussian filtering<sup id="cite_ref-1" class="reference"><a href="TrackMate_Performance.html#cite_note-1">&#91;1&#93;</a></sup>, this is avoided.
</p><p>The LoG detector shows a near-constant processing time, which makes it desirable for spots larger than 2 pixels in radius. This is due to the way we compute the convolution which is explained below. 
</p><p><br />
</p>
<h4><span class="mw-headline" id="Processing_time_for_a_3D_image_as_a_function_of_the_spot_radius.">Processing time for a 3D image as a function of the spot radius.</span></h4>
<p>This time we used a 256x256x256 3D image, but with otherwise the same parameters. 
</p><p><a href="./File:TrackMate_DoGandLoGTimeVsRadius3D.png" class="image"><img alt="TrackMate DoGandLoGTimeVsRadius3D.png" src="_images/a/ad/TrackMate_DoGandLoGTimeVsRadius3D.png" width="400" height="321" /></a>
</p><p>The processing time increases, but this time deviates slightly from linearity in the DoG case. We retrieve the 3D kernel overhead we had for the 3D images.
</p><p>The LoG performance clearly highlights the 0-padding used because of the Fourier transform: Indeed, the processing time increase in a step-wise manner. We use the Fourier transform to compute the convolution by the LoG kernel. But for the implementation we use, the kernel image (and the source image as well) are padded by 0 until their size reaches a power of 2 (128, 256, 512, etc...). Whenever the required kernel size is smaller than this power of 2, its size is increased to this value. Because ultimately the processing time depends on the number of pixels, we see a constant processing time until the kernel size imposes a larger power of 2.
</p>
<h4><span class="mw-headline" id="Choosing_between_DoG_and_LoG_based_on_performance">Choosing between DoG and LoG based on performance</span></h4>
<p>This stepwise evolution makes it slightly harder to choose between LoG and DoG detectors based on performance. As a crude rule of thumb we will remember that
</p>
<ul><li> The LoG detector outperforms the DoG detector in 2D for radiuses larger than 2 pixels.</li>
<li> The LoG detector outperforms the DoG detector in 3D for radiuses larger than 4 pixels.</li></ul>
<p><br />
</p>
<ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="TrackMate_Performance.html#cite_ref-1">↑</a></span> <span class="reference-text"><a rel="nofollow" class="external free" href="https://github.com/imagej/imglib/blob/master/algorithms/core/src/main/java/net/imglib2/algorithm/gauss3/Gauss3.java">https://github.com/imagej/imglib/blob/master/algorithms/core/src/main/java/net/imglib2/algorithm/gauss3/Gauss3.java</a></span>
</li>
</ol>

<!-- 
NewPP limit report
Cached time: 20200713074015
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.032 seconds
Real time usage: 0.034 seconds
Preprocessor visited node count: 49/1000000
Preprocessor generated node count: 86/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/3
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="index.php?title=TrackMate_Performance&amp;oldid=9536">http://imagej.net/index.php?title=TrackMate_Performance&amp;oldid=9536</a>"</div>
							</div>

			<div id="footer">
				<p> This page was last modified on 16 January 2014, at 10:00.</p><ul><li><a href="./ImageJ:Privacy_policy" title="ImageJ:Privacy policy">Privacy policy</a></li><li><a href="./ImageJ:About" class="mw-redirect" title="ImageJ:About">About ImageJ</a></li><li><a href="Imprint" title="Imprint">Imprint</a></li><li><a href="index.php?title=TrackMate_Performance&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li></ul>			</div>

			<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>		</div>

		<div id="bottom-wrap">
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.load(["ext.fancytree","ext.suckerfish","ext.cite.a11y","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.SimpleTooltip"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":250});});</script>
		</body>
		</html>
		